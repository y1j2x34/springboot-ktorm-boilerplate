---
description: Gradle build configuration and Spring Boot auto-configuration notes.
globs: "**/build.gradle.kts"
---

# Build Configuration

## Module build.gradle.kts Pattern

- Library modules (non-executable): Disable `bootJar`, enable `jar`
- Dependencies: Use `api()` for transitive dependencies, `implementation()` for internal

Example:

```kotlin
tasks.bootJar {
    enabled = false
}
tasks.jar {
    enabled = true
}

dependencies {
    implementation(project(":core"))
    api(project(":module-api"))  // If exposing API to other modules
}
```

## Auto-configuration Note

- Modules are ordinary application modules, not published starters.
- **Do not** add `META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports` unless building an auto-configuration starter.
- Rely on normal `@Configuration` and component scanning.

## Redis Usage

- **MUST** use the existing `infrastructure-redis` module for all Redis operations.
- **MUST** use `RedisCacheService` for caching operations (do not use `RedisTemplate` directly for caching).
- **MUST** use `RedisLockService` for distributed locking (do not implement custom lock logic).
- Inject services via constructor: `class MyService(private val redisCacheService: RedisCacheService, private val redisLockService: RedisLockService)`
- Prefer `getOrSet()` method for cache operations to avoid cache penetration.
- Use `executeWithLock()` method for distributed locking to ensure proper lock lifecycle management.
